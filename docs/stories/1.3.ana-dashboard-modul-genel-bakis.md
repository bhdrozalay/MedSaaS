# Story 1.3: Ana Dashboard ve Modül Genel Bakış

**Story ID:** 1.3  
**Epic:** Platform Temel Altyapısı  
**Status:** Draft  
**Story Points:** 10  
**Sprint:** Sprint 3

## User Story
**As a** şirket çalışanı (herhangi bir departmandan)  
**I want to** kendi departmanıma uygun bir dashboard ile günlük işlerimi takip edebilmek  
**So that** platformu etkili kullanabilmek ve işlerimi organize edebilmek

## Acceptance Criteria

### AC-01: Departmana Özel Dashboard Görünümü
- [ ] **Satış Departmanı Dashboard'u:**
  - Günlük ziyaret listesi widget'ı
  - Bu hafta yapılan ziyaret sayısı
  - Aktif tender'lar özeti
  - Müşteri takip durumu
- [ ] **Depo Departmanı Dashboard'u:**
  - Kritik stok seviyesi uyarıları
  - Bugün çıkacak siparişler
  - Depo doluluk oranı
  - Tedarikçi siparişleri durumu
- [ ] **Muhasebe Departmanı Dashboard'u:**
  - Günlük gelir/gider özeti
  - Ödenecek faturalar
  - Tahsil edilecek alacaklar
  - Aylık kar/zarar trendi
- [ ] **Yönetici Dashboard'u:**
  - Tüm departmanların özet metrikleri
  - Şirket geneli performans indikatörleri
  - Kritik uyarılar ve onay bekleyen işler

### AC-02: Hızlı Eylem Butonları
- [ ] Her departman için hızlı erişim butonları:
  - Satış: "Yeni Ziyaret Ekle", "Tender Ara"
  - Depo: "Stok Kontrol", "Sipariş Ver"  
  - Muhasebe: "Fatura Kes", "Ödeme Yap"
  - Yönetici: "Rapor Oluştur", "Onay Bekleyen İşler"
- [ ] Butonlar sadece ilgili yetkilere sahip kullanıcılara görünür
- [ ] Modal veya direkt sayfa yönlendirmesi seçenekleri

### AC-03: Modül Durumu ve Erişim Kontrolü
- [ ] Kullanıcının erişebildiği modüller liste halinde görünür
- [ ] Her modül için:
  - Modül adı ve ikonu
  - Son kullanım tarihi
  - Aktif/pasif durumu (demo/paid)
  - Son aktivite özeti
- [ ] Demo modunda "Demo" badge'i görünür
- [ ] Pasif modüller "Abonelik Gerekli" mesajı ile disabled görünür

### AC-04: Global Arama Özelliği
- [ ] Üst menüde arama kutusu bulunur
- [ ] Arama şunları kapsar:
  - Müşteriler (satış dept. için)
  - Ürünler/stoklar (depo dept. için)
  - Faturalar (muhasebe dept. için)
  - Raporlar (tüm depts. için)
- [ ] Arama sonuçları role-based filtrelenmiş olur
- [ ] Minimum 3 karakter yazıldıktan sonra autocomplete çalışır
- [ ] Son aranan öğeler cookie'de saklanır

### AC-05: Bildirim Merkezi
- [ ] Sağ üst köşede bildirim ikonu (bell)
- [ ] Bildirimler şu türlerde olabilir:
  - Sistem uyarıları (demo süresi vs.)
  - Departman specific (stok azaldı, fatura vadesi vs.)
  - Onay bildirimleri (yöneticiler için)
  - Başarı mesajları (işlem tamamlandı vs.)
- [ ] Okunmayan bildirim sayısı badge ile gösterilir
- [ ] Bildirimler "okundu" olarak işaretlenebilir
- [ ] Geçmiş bildirimler 30 gün boyunca saklanır

### AC-06: Kişiselleştirme Özellikleri
- [ ] Dashboard widget'ları drag & drop ile yeniden düzenlenebilir
- [ ] Widget'ları gizleme/gösterme seçeneği
- [ ] Widget boyutları değiştirilebilir (küçük, orta, büyük)
- [ ] Kişisel dashboard düzeni kullanıcı bazında kaydedilir
- [ ] "Varsayılan düzene sıfırla" özelliği
- [ ] Departman şablonları (admin tarafından tanımlı)

### AC-07: Performance ve Yükleme
- [ ] Dashboard 3 saniye içinde tam yüklenir
- [ ] Widget'lar ayrı ayrı (progressive loading) yüklenir
- [ ] Yavaş yüklenen widget'larda skeleton loader gösterilir
- [ ] Kritik data cache'lenir (1 saatlik cache)
- [ ] Hata durumunda "Yeniden dene" seçeneği

### AC-08: Mobil Uyumluluk
- [ ] Dashboard mobil cihazlarda tam uyumlu çalışır
- [ ] Touch-friendly widget'lar ve butonlar
- [ ] Swipe gestures ile widget navigation
- [ ] Mobil menu/navigation pattern
- [ ] Portrait ve landscape mod desteği
- [ ] iOS ve Android native app görünümü

### AC-09: Demo Tenant Özellikleri
- [ ] Demo tenant'larda "Demo Modu" banner'ı görünür
- [ ] Demo süre sayacı dashboard'da prominently gösterilir
- [ ] Demo data ile dolu widget'lar (realistic test data)
- [ ] "Abonelik Satın Al" CTA button prominently placed
- [ ] Demo özellikleri interactive guide ile tanıtılır

### AC-10: Güvenlik ve Audit
- [ ] Dashboard erişimi audit log'da tutulur
- [ ] Widget data'sı tenant bazında izole edilmiş
- [ ] Sensitive data masking (opsiyonel admin setting)
- [ ] Session timeout uyarıları dashboard'da gösterilir
- [ ] Güvenlik notifikasyonları (şüpheli giriş vs.)

## Technical Requirements

### Frontend Architecture
```typescript
// Dashboard Layout Component
interface DashboardLayoutProps {
  userRole: UserRole;
  departmentId: string;
  widgets: Widget[];
  isDemo?: boolean;
}

// Widget System
interface Widget {
  id: string;
  type: 'metric' | 'chart' | 'list' | 'quick-action';
  title: string;
  data?: any;
  position: { x: number, y: number };
  size: 'sm' | 'md' | 'lg';
  permissions: string[];
}

// Department Specific Interfaces
interface SalesDashboardData {
  todayVisits: Visit[];
  weeklyStats: WeeklyStats;
  activeTenders: Tender[];
  customerFollowUps: CustomerTask[];
}
```

### API Endpoints
- `GET /api/dashboard/data` - Dashboard data (role filtered)
- `POST /api/dashboard/layout` - Save custom layout
- `GET /api/search/global?q={query}` - Global search
- `GET /api/notifications` - User notifications
- `POST /api/notifications/{id}/mark-read` - Mark notification read

### State Management (Zustand)
```typescript
interface DashboardState {
  widgets: Widget[];
  layout: LayoutConfig;
  notifications: Notification[];
  isLoading: boolean;
  updateLayout: (layout: LayoutConfig) => void;
  fetchData: () => Promise<void>;
}
```

### Caching Strategy
- Widget data: 1 hour cache
- User preferences: LocalStorage
- Search results: 15 minutes cache
- Critical metrics: Real-time updates

### Mobile Components
- `MobileDashboard.tsx`
- `SwipeableWidgets.tsx`
- `MobileNavigation.tsx`
- `TouchOptimizedButtons.tsx`

## Performance Targets
- **Initial Load:** < 3 seconds
- **Widget Refresh:** < 1 second
- **Search Response:** < 500ms
- **Mobile Performance:** 60 FPS animations

## Definition of Done
- [ ] Tüm AC'ler test edildi ve geçti
- [ ] Performance benchmarks karşılandı
- [ ] Mobile responsiveness all devices tested
- [ ] Security audit tamamlandı (role-based filtering)
- [ ] Accessibility (WCAG 2.1 AA) compliance
- [ ] E2E testler tüm user flows için yazıldı
- [ ] Widget system documented
- [ ] Demo flow testing completed

## Dependencies
- Story 1.1: Tenant infrastructure
- Story 1.2: User management and roles
- Zustand store setup
- React Query configuration
- Mobile app navigation structure

## Risk & Mitigation
- **Risk:** Dashboard complexity overwhelming users
- **Mitigation:** Department-specific defaults + progressive disclosure

- **Risk:** Performance issues with many widgets
- **Mitigation:** Lazy loading + efficient caching + virtualization

## Notes
Bu story, kullanıcıların günlük platformla etkileşiminin merkezi noktasıdır. Her departmanın iş akışına uygun bir deneyim sunması kritik. Dashboard'un başarısı, kullanıcı adaptasyonunu ve platformun genel kabulünü direkt etkileyecektir.

Next stories muhtemelen core business modüllerden başlayacak (Ziyaret Takibi, Envanter Yönetimi, Finansal İşlemler).